#Task 1: Understand & Explore Linux Authentication Logs
The goal of this task is to learn what's inside Linux authentication logs, where they live, and what login activity actually looks like
I found that authenication logs activity are located and stored from the root with the path going to /var/log/auth.log.
I learned a new command <less>, which allows you make a pager view of content you want to look at so to view the authentication activity in my computer i did <sudo less /var/log/auth.log>.
Notable authentication events that I saw more then once are: session opened, session closed, new session 1 of user isaiah, loading rules, conversation failed, authentication failure, system is powering down, new seat seat0, and sudo: isaiah: 1 incorrect password attempt.
I learned a new command <grep>, which allows you to search within a file and display all occurances of a specified text pattern. I did the command <sudo grep "incorrect password attempt" auth.log> and recieved the output: 2025-12-30T16:16:41.589778-05:00 DESKTOP-8F1OJR0 sudo:   isaiah : 1 incorrect password attempt ; TTY=pts/2 ; PWD=/home/isaiah/workspace/Linux_Hardening_Access_Control_Lab ; USER=root ; COMMAND=/usr/sbin/groupadd securefiles, 2025-12-30T16:22:23.846786-05:00 DESKTOP-8F1OJR0 sudo:   isaiah : 2 incorrect password attempts ; TTY=pts/2 ; PWD=/home/isaiah/workspace/Linux_Hardening_Access_Control_Lab ; USER=root ; COMMAND=/usr/bin/passwd, 2025-12-31T14:22:49.033195-05:00 DESKTOP-8F1OJR0 sudo:   isaiah : TTY=pts/0 ; PWD=/var/log ; USER=root ; COMMAND=/usr/bin/grep 'incorrect password attempt' auth.log. These logs tell me that 12-30-2025 I had two incorrect password attempts when trying to do add a new group secrurefiles and one incorrect password attempt on 12-31-2025 when i tried to print witht the grep command.
I also did <sudo grep "authentication failure" auth.log> and got the output: 2025-12-31T14:51:55.771663-05:00 DESKTOP-8F1OJR0 sudo:   isaiah : TTY=pts/0 ; PWD=/var/log ; USER=root ; COMMAND=/usr/bin/grep 'authentication failure' auth.log. For each line that is logged i see: the date, time and timezone it was logged, the hostname of where it happened, an indidcation that sudo was used in this command, the user isaiah that made the command, indication of the command being made in a terminal, the path of the working directory where the command was made, user having root privileges, the exact command made. So looking at this log I can say the user isaiah correctly executed sudo to run the command grep from a terminal.
I also purposely inserted incorrect passwords using <sudo su> to indicate failed authenication attmepts. Then I did the command <sudo grep "authentication failure" auth.log> again and got this: 2025-12-31T15:06:51.172112-05:00 DESKTOP-8F1OJR0 sudo: pam_unix(sudo:auth): authentication failure; logname= uid=1000 euid=0 tty=/dev/pts/0 ruser=isaiah rhost=  user=isaiah. This line shows: the date time and timezone, hostname, sudo usage, sudo authentication usage, event type, logname (which is empty becasue it's a local login), user identification attempting sudo, sudo was attempted but failed, indication of the terminla session, which user typed the command, rhost (which is the remote ip address involved but empty becasue it's done by local system), and the user being authenticated. So from this line in the logs I could say the user isaiah tried to use escalate their privileges using sudo on their local terminal device and their attempt failed.

#Task 2: Detection and Analysis
The goal of this task is to identify suspious patterns, like brute force behavior.
I found how many occurances of "authentication failure" using the command <sudo grep "authentication failure" auth.log | wc -l> and got the output: 8. Even though this is a high number of authentication failures. Becasue it's from me using my own local device, its not suspicious behavior and is a low severity.
I learned that an indication of a potential brute force attack is: there were 20+ failures, a rapid amount of tries, multiple usernames, long gaps bewteen tries, or if the failures were targeting privileged files or accounts. I also learned a sample rule with detection logic, which is to flag a user if more then 10 authentication failures occur within 5 minutes. With logic I did the command <sudo grep "authenication failure" auth.log |awk '{print $1, $2, $3}'> to print the first 3 columns and got the output: 2025-12-30T16:16:31.497711-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-30T16:16:54.983429-05:00 DESKTOP-8F1OJR0 passwd[1716]:, 2025-12-30T16:17:13.398316-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T14:51:55.771663-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T15:06:51.172112-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T15:07:43.041190-05:00 DESKTOP-8F1OJR0 sudo:, 
2025-12-31T18:30:29.048502-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T18:30:34.377442-05:00, DESKTOP-8F1OJR0 sudo:, 2025-12-31T19:09:49.413308-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T19:11:02.586954-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T19:12:28.733345-05:00, DESKTOP-8F1OJR0 sudo:, 2025-12-31T19:12:50.094465-05:00 DESKTOP-8F1OJR0 sudo:, 2025-12-31T19:18:54.577177-05:00 DESKTOP-8F1OJR0 sudo:. Becasue of the attempts that happened at 16:16:31, 16:16:54, 16:17:13 this could be suspicious activity but we also know that those logs were done by the same user and on the same hostname so it can be concluded that the user type in their password incorrectly.

#Task 3: Automation
The goal of this task is to build a defensive security tool from a python script that reads Linux authentication logs, detect excessive authenticaiton failures, print suspicious activity to the terminal, and writes a summary report to a file. 
For this tool I made it in Python3. I imported the regualr expression, datetime, and defaultdict libraries.
What the tool does is reads from the authentication logs. Then it will look specifically for the failed attempted logs and recieves their username and timestamps of those failed attempts. Once it gets the user and their timestamps, it'll calculate rather all their failed attmpets happened wthin a 5 minute time window. If they are the user will be classified as a suspicious user. If there are suspicious users then I would be notified with this message: "Suspicious authentication activity detected." If there are no suspicious users then I would be notified with this message: "No suspicious authentication activity detected."
